# word2vec-SISG
《Billion-scale Recommendation with Heterogeneous Side Information at Taobao》
non-official pytorch version


## Usage
```
pip install word2vec-SISG==1.0.0
from word2vec.trainer import Word2VecTrainer
w2v = Word2VecTrainer(input_file="input.txt", output_file="out.vec",
                          side_num=0, neg_num=2, sentences_count=3, emb_size=[1375017],
                          batch_size=64)
w2v.train()
```


## Data Sructure
```
input.txt  //side_num=0, neg_num=2, sentences_count=3, emb_size=[vocabulary_size]
//word_i word_j neg_word_1 neg_word_2 co_occurrence_ij
0 1 965097 1273638 22
15 365335 24902 513014 2
26 23974 157618 39630 4

input.txt //side_num=1, neg_num=1, sentences_count=3, emb_size=[vocabulary_size,side_feature_1_size]
//word_i word_j neg_word_1 co_occurrence_ij
0_7 1_6 965097_3 22
15_1 365335_3 24902_5 2
26_2 23974_1 157618_7 4
```

```
out.vec_0 // word embedding
0 -0.22501896 0.1102703 -0.19134396 -0.15793265 0.13858497 0.20848127 -0.15450473 0.14276423 0.13857637 -0.21482877 -0.17313838 0.1852358 0.053593036 -0.20998214 0.21894735 0.20701826 0.17479646 0.18386732 -0.195735 -0.09515758 0.09933794 0.21186021 0.22125009 -0.1380073 -0.20250705 -0.1901133 -0.14187697 0.13159978 0.13744362 0.05619751 -0.2157791 0.18773217 0.17777179 -0.17694633 0.1634303 -0.17497003 0.14461929 0.11593465 0.20673794 0.14380935 0.19527447 0.15204105 0.17150226 -0.1998707 0.19034319 0.21654448 0.1687789 0.18351842 -0.13899595 -0.21403408 -0.19906671 0.21735649 -0.08163537 -0.19734475 -0.22379881 -0.17650187 0.16140349 -0.18704237 0.17444633 -0.2197106 -0.13467434 0.23159903 -0.17060556 -0.22698613 -0.1134465 -0.17771132 0.18334685 0.20913188 0.1687542 -0.19162421 -0.22885476 0.16152659 0.17968492 0.17848681 -0.15548591 0.22295927 -0.22346371 0.11678343 -0.13932645 0.13783106 -0.13817167 0.18497221 0.14207448 0.2263855 0.21223463 -0.18017195 -0.077051744 -0.19126034 -0.15494485 -0.21899785 -0.17357166 0.14362822 0.19307283 -0.19112444 0.17697915 0.21797141 0.21146475 -0.22114347 -0.13339378 0.12899847

out.vec_1 // side_feature_1 embedding
0 -0.21068326 0.108188756 0.19159819 0.04094604 -0.2241301 -0.16976719 -0.109396346 -0.169138 -0.33005923 -0.12673344 0.26759925 0.12832941 -0.26474547 -0.052520655 -0.063665114 -0.0867028 -0.025637396 -0.022944435 0.27874565 0.047899485 0.06219181 -0.17411253 -0.16278175 -0.053352505 0.034808252 -0.14927107 -0.025825696 -0.042207647 -0.6334164 -0.121542424 0.101262875 0.0037863848 0.24216941 0.043732576 0.22839405 -0.12942016 0.09408886 0.20355727 -0.063917056 0.14967552 0.03170251 -0.13710696 0.20371509 0.22637714 -0.2927256 0.054756377 0.07420636 -0.033374935 -0.33559406 0.10478428 0.022602899 0.08114438 0.17597002 -0.13810493 0.209116 0.10655351 0.062055547 -0.07975316 0.023396812 0.09725256 0.05756679 -0.086014636 -0.12422809 -0.11050051 -0.4840745 0.048644885 0.07095465 0.0042517995 0.017436549 0.124105826 -0.1369571 0.049692925 0.062022056 -0.10928774 0.43674007 -0.013854978 -0.069344945 -0.038846914 -0.20502883 0.40232456 -0.0049308166 0.24817695 0.17453958 0.022047544 -0.028436074 -0.26532954 0.10746371 -0.10758309 -0.04223847 0.35398293 -0.014641835 0.2843285 -0.14713913 -0.013326409 0.24374618 -0.101269685 0.028569873 -0.07374877 -0.008621882 -0.096809566
```
